<!DOCTYPE html>  <!--TODO: load from base.html-->
<html lang="en-GB">
{% load static %}
{% load account socialaccount %}

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Home - Pulsifi</title>
    <link href="{% static 'pulsifi/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
</head>

<main>
    <nav class="navbar rounded-bottom navbar-light navbar-expand-lg pl-5 pr-5" style="background-color: #ba03fc;">   <!--TODO: load from navbar.html (only show links if logged in)-->
        <a class="navbar-brand align-middle" href="{% url 'default' %}">
            <img height=30px src="{% static 'pulsifi/brand/Logo-White_Transparent.png' %}" alt="Pulsifi Logo">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
            aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <button class="d-none" id="sign-up"></button>   <!--TODO: remove hidden button-->
                <a class="nav-link"><button type="button" class="btn btn-light" id="sign-in">Sign In/Up</button></a>
            </div>
        </div>   <!--TODO: add profile icon-->
    </nav>

    <div class="mx-auto" style="width: 75%">
        <div class="container-fluid p-4 text-center">
            <h1 style="color:#ba03fc">Hello! Welcome to <strong>Pulsifi</strong></h1>
            <br>
            <h3>The most <strong><em>intense</em></strong> social media platform in existence</h3>
            <br>
            <img class="p-3" src="{% static 'pulsifi/brand/Logo-Purple_Transparent.png' %}" width=50% alt="Pulsifi Logo">   <!--TODO: remove redundant image-->
            <br>
            <h4>How does Pulsifi work?</h4>
            <br>
            <p>We augment social media, and make it more intense than accidentally eating the stray ghost chilli in your Jalfrezi.</p>
            <p>Every time you post, your post will have just 10 minutes to survive. But, for every like your post receives, your post will be blessed with an extra 2 minutes of life. For every dislike though, it will lose 1 minute.</p>
            <p>Once 10 minutes is up, or your post has 0 likes, it will disappear off the face of the earth.</p>
        </div>
    </div>

    <!--Adapted from https://dev.to/ara225/how-to-use-bootstrap-modals-without-jquery-3475-->
    <!--SIGN IN MODAL; WILL DISPLAY SIGN IN FORM-->
    <div class="modal fade" id="sign-in-modal" tabindex="-1">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exammodalLabel">Sign In</h5>
                    <button type="button" class="close" id="close-sign-in" aria-label="Close" onclick="closeModal('sign-in-modal');">
                        <span aria-hidden="true">x</span>
                    </button>
                </div>
                <div class="modal-body">
                    {% get_providers as socialaccount_providers %}
                    {% if socialaccount_providers %}
                        {% for socialaccount_provider in socialaccount_providers %}
                            <form action="{% provider_login_url socialaccount_provider.id %}" method="post">
                                {% csrf_token %}
                                <button class="btn text-white mb-1" type="submit" style="background-color: #ba03fc;">Log in with {% if socialaccount_provider.id == "microsoft" %}Microsoft{% else %}{{ socialaccount_provider.name }}{% endif %}</button>
                            </form>
                        {% endfor %}
                    {% endif %}

                    <h5 class="mt-3">Or log in with a local account</h5>

                    <form method="post">  <!--TODO: generate form from default AuthenticationForm-->
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="sign-in-username">Username</label>
                            <input type="text" autocapitalize="none" name="username" maxlength="50" autocomplete="username" required class="form-control" id="sign-in-username" placeholder="Enter your email address">
                        </div>
                        <div class="form-group">
                            <label for="sign-in-password">Password</label>
                            <input type="password" name="password" autocomplete="current-password" required class="form-control" id="sign-in-password" placeholder="Enter your password">
                        </div>
                        <input type="hidden" name="next" value="{{ next }}">
                        <div class="modal-footer">
                            <a style="margin-right: 2rem;" href="{% url 'pulsifi:signup' %}{% if "next" in request.GET %}?next={{ request.GET.next|urlencode }}{% endif %}">Create a local account</a>
                            <button type="submit" class="btn text-white" id="sign-in-submit" style="background-color: #ba03fc;">Sign In</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>   <!--TODO: show errors in modal-->
    <div class="modal-backdrop fade show" id="backdrop" style="display: none;"></div>

{#    {% if next in request.GET %}   <!--TODO: make signin modal show by default when next GET parameter exists-->#}
{#        <script>#}
{#            openModal("sign-in-modal");#}
{#        </script>#}
{#    {% endif %}#}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>
    <script src="{% static 'pulsifi/js/home.js' %}"></script>
</main>
